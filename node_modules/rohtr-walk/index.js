const fs = require('fs')
const path = require('path')
const models = require('rohtr-models')

function walk(options) {
	options = options || {}

	if(!options) 		throw 'Object expected'
	if(!options.root) 	throw 'Object "root" expected'

	var root = options.root;
	var parent = options.parent || false
	var _path = path.resolve(root)
	var base = path.basename(_path)
	
	var folder = new models.Folder();
	var allfiles = fs.readdirSync(root).map(f=>path.resolve(root,f))
	var files = []
	var folders = []

	allfiles.map(fs.statSync).forEach((stat, index) => {
		var file = allfiles[index]
		var isFile = !stat.isDirectory()

		if(isFile) files.push(file)
			else folders.push(file)
	})

	folder.parent  = parent
	folder.basedir = base
	folder.path    = _path
	folder.files   = files
	folder.folders = folders

	console.log(folder)

	return folder;	
}

module.exports = walk